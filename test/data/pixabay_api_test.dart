import 'package:flutter_test/flutter_test.dart';
import 'package:image_search/ui/data/pixabay_api.dart';
import 'package:mockito/annotations.dart';
import 'package:http/http.dart' as http;
import 'package:mockito/mockito.dart';

import 'pixabay_api_test.mocks.dart';

@GenerateMocks([http.Client])
void main(){

  test("Pixabay api를 잘가져와야 한다.", () async{
    final api = PixabayApi();
    
    final client = MockClient();

    when(client.get(Uri.parse(
        "${PixabayApi.baseUrl}?key=${PixabayApi.key}&q=iphone&image_type=photo")))
    .thenAnswer((_) async => http.Response(fakeJsonBody,200));

    
    final result = await api.fetch("iphone",client: client);
    
    expect(result.first.id, 410311);
    verify(client.get(Uri.parse(
        "${PixabayApi.baseUrl}?key=${PixabayApi.key}&q=iphone&image_type=photo")));
  });
}

String fakeJsonBody = """
{"total":8673,"totalHits":500,"hits":[{"id":410311,"pageURL":"https://pixabay.com/photos/iphone-hand-screen-smartphone-apps-410311/","type":"photo","tags":"iphone, hand, screen","previewURL":"https://cdn.pixabay.com/photo/2014/08/05/10/27/iphone-410311_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/ged4f74d8fb3bc9fdaa3c11cbae2f3c47a8fe07184c138e00fb34f08d7594730cad9c063e4ac852c7c8a60f8331646dfe_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g1c9c6c005edad63be619e8208515f1a47f92ff552d2a15e8859ef8bf1f9e02609ae0f49fa67324253946f7a6c6fb87e94b31cbbd1e8a77e8f9b4cd4309592167_1280.jpg","imageWidth":1920,"imageHeight":1280,"imageSize":416413,"views":478251,"downloads":233940,"collections":4959,"likes":570,"comments":157,"user_id":264599,"user":"JESHOOTS-com","userImageURL":"https://cdn.pixabay.com/user/2014/06/08/15-27-10-248_250x250.jpg"},{"id":410324,"pageURL":"https://pixabay.com/photos/iphone-smartphone-apps-apple-inc-410324/","type":"photo","tags":"iphone, smartphone, apps","previewURL":"https://cdn.pixabay.com/photo/2014/08/05/10/30/iphone-410324_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/gb17743e80afa8ce198a08523b1fa283f4ee9280ef9e2d9da8199eb357397241482c32735521f3f52cbbe217f973820c5_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/gd5e9f662a6faba18060bed96d051219578290ba427e29852e11b8d61c6e73a1eba89d77b52ff4b72a068c1c77f3d40ea5833d4a08a8b1396a5cba8622cf6c77b_1280.jpg","imageWidth":2180,"imageHeight":1453,"imageSize":477025,"views":625170,"downloads":350013,"collections":5864,"likes":742,"comments":193,"user_id":264599,"user":"JESHOOTS-com","userImageURL":"https://cdn.pixabay.com/user/2014/06/08/15-27-10-248_250x250.jpg"},{"id":2846221,"pageURL":"https://pixabay.com/photos/business-computer-mobile-smartphone-2846221/","type":"photo","tags":"business, computer, mobile","previewURL":"https://cdn.pixabay.com/photo/2017/10/12/22/17/business-2846221_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g46773ec4ce56bdeeba3271ab4cb975d910df6f3940c42654decb061934a529e53c7abd94ca2d291c140154e8605576b1058d51504c5c7fdb284c0f9c09c80f37_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g482f21d381b6e34a7dada15602591c29f044bad83fa085fd747df3ccb18aa4d3f32dd5c66e0572781d834f7dc27382fc639c7afcbb17cfa083eeb7697fb49399_1280.jpg","imageWidth":4608,"imageHeight":3072,"imageSize":2543501,"views":343243,"downloads":243595,"collections":3461,"likes":584,"comments":86,"user_id":6689062,"user":"6689062","userImageURL":""},{"id":1867461,"pageURL":"https://pixabay.com/photos/apple-iphone-close-up-smartphone-1867461/","type":"photo","tags":"apple, iphone, close up","previewURL":"https://cdn.pixabay.com/photo/2016/11/29/05/08/apple-1867461_150.jpg","previewWidth":150,"previewHeight":100,"webformatURL":"https://pixabay.com/get/gba3501b7b3a7f56fac82f234761ee06dbe89a24e77dab2359e8b1fd19fa2903b00b16c233a563f8176c1824b2fc1db4e4763adeb386cee077b4788a0c9788704_640.jpg","webformatWidth":640,"webformatHeight":427,"largeImageURL":"https://pixabay.com/get/g694138e8498b94c7edd399fe182d745a2b373a3728deb7056c090e1dfbc977858575535884c0bfbdd183106d4e31a70e6bb3c58c31a90e6c2b16daa612e47729_1280.jpg","imageWidth":5252,"imageHeight":3507,"imageSize":1410507,"views":59740,"downloads":34992,"collections":1209,"likes":116,"comments":18,"user_id":2286921,"user":"Pexels","userImageURL":"https://cdn.pixabay.com/user/2016/03/26/22-06-36-459_250x250.jpg"},{"id":620817,"pageURL":"https://pixabay.com/photos/office-notes-notepad-entrepreneur-620817/","type":"photo","tags":"office, notes, notepad","previewURL":"https://cdn.pixabay.com/photo/2015/02/02/11/08/office-620817_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/gf8da5aeb40477b3141837c9825aa6512576270419206380d15f2cb63e1c94c91b0a6e4d8ada6f6a95d9ee7b1c76c5cd3_640.jpg","webformatWidth":640,"webformatHeight":425,"largeImageURL":"https://pixabay.com/get/gebc75f131b7214813524bccf929088be88d8f164caea5ce3056ecf01be384f82137fcfa4bb45c4661122a30c1bac4c9127d13af698f28f9d20c28429caf865cf_1280.jpg","imageWidth":4288,"imageHeight":2848,"imageSize":2800224,"views":667982,"downloads":286970,"collections":4886,"likes":1059,"comments":247,"user_id":663163,"user":"Firmbee","userImageURL":"https://cdn.pixabay.com/user/2020/11/25/09-38-28-431_250x250.png"},{"id":1192032,"pageURL":"https://pixabay.com/photos/girl-smartphone-iphone-1192032/","type":"photo","tags":"girl, smartphone, iphone","previewURL":"https://cdn.pixabay.com/photo/2016/02/10/16/39/girl-1192032_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g16f1bce21b2d2832b5a27be811277693f23508fe7da69d3650b0f199e232fd60b8435f03c8ef1ee5d450376c2dbe0ae4feecdfaf1b02579bf926866dad40130d_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/gda88c26173de8baed3dc31b34cc3791ec81791e0ee1bcfe49f216ab1870005c304ce7a5a6e025355ee48612295106c170c9c94982cb2a13a5c9145c1acfca500_1280.jpg","imageWidth":2048,"imageHeight":1367,"imageSize":299773,"views":97578,"downloads":46566,"collections":736,"likes":190,"comments":16,"user_id":725943,"user":"janeb13","userImageURL":"https://cdn.pixabay.com/user/2016/02/25/23-52-46-967_250x250.jpg"},{"id":5537230,"pageURL":"https://pixabay.com/photos/iphone-hand-phone-mobile-phone-5537230/","type":"photo","tags":"iphone, hand, phone","previewURL":"https://cdn.pixabay.com/photo/2020/09/02/03/26/iphone-5537230_150.jpg","previewWidth":150,"previewHeight":100,"webformatURL":"https://pixabay.com/get/gb393f3a04d0aa348072413a4f4cf483ca1c55eb16e3fc62394ce70102cf478a3c3e592fc09d11b25e7b31230ddaa093fcf61c15e4c657c9e42a2909ecf458282_640.jpg","webformatWidth":640,"webformatHeight":427,"largeImageURL":"https://pixabay.com/get/g570f3ad9d8674cba2412748cefa4fdd05f1f0491832e14e7dc6b1585da8c51f2dc4146bf33df3d01bdfef6491af584085f901f4e09f638a424f69237bf794264_1280.jpg","imageWidth":6000,"imageHeight":4000,"imageSize":2408760,"views":52539,"downloads":32142,"collections":1364,"likes":81,"comments":11,"user_id":498081,"user":"tranmautritam","userImageURL":"https://cdn.pixabay.com/user/2015/01/22/05-13-32-817_250x250.jpg"},{"id":4106766,"pageURL":"https://pixabay.com/photos/astronaut-moon-space-nasa-planet-4106766/","type":"photo","tags":"astronaut, moon, space","previewURL":"https://cdn.pixabay.com/photo/2019/04/06/06/44/astronaut-4106766_150.jpg","previewWidth":100,"previewHeight":150,"webformatURL":"https://pixabay.com/get/ge0b9a262b7e29918656566fcae7efed179bf2958f933a18164da3815dc85c82f0e20cc702f68aaf2b0c24bfca42b39df73c1e47feb3c5c298639688ed07bd2e7_640.jpg","webformatWidth":426,"webformatHeight":640,"largeImageURL":"https://pixabay.com/get/gb06491fbee6ec1999c3d230b4491333440c97c3fdba349f2cb820c02c61c29693e010e2d463b3a7c83abcc4edcc5b265dff2ca3edcbae9967ca31c0f88a47d26_1280.jpg","imageWidth":4000,"imageHeight":6000,"imageSize":2047424,"views":491900,"downloads":370484,"collections":7063,"likes":955,"comments":102,"user_id":12044322,"user":"pizar_kestrap","userImageURL":""},{"id":2681039,"pageURL":"https://pixabay.com/photos/watercolor-painting-colorful-art-2681039/","type":"photo","tags":"watercolor, painting, colorful","previewURL":"https://cdn.pixabay.com/photo/2017/08/25/18/48/watercolor-2681039_150.jpg","previewWidth":99,"previewHeight":150,"webformatURL":"https://pixabay.com/get/ge089935716f8ad09b98e505397fcbf2f524bd5331db2304b16fa0489ad16dce51e9c03ed7ac9df86c6ef2a3958b435ac3494c5756cb4e4d82a5e8c2cd3144fe4_640.jpg","webformatWidth":424,"webformatHeight":640,"largeImageURL":"https://pixabay.com/get/g016cffbd00f5d8c9dfdd416fd61624dd4e6fe3536edf63deb8ee9d1d138381ba6677404b11037ec9cef72e9c14b46151c62db3eac0fc72133cd599708d85fefc_1280.jpg","imageWidth":3264,"imageHeight":4928,"imageSize":5021313,"views":823060,"downloads":626253,"collections":6181,"likes":1081,"comments":108,"user_id":4894494,"user":"eluela31","userImageURL":"https://cdn.pixabay.com/user/2017/04/24/19-55-29-652_250x250.jpg"},{"id":459196,"pageURL":"https://pixabay.com/photos/macbook-laptop-google-display-459196/","type":"photo","tags":"macbook, laptop, google","previewURL":"https://cdn.pixabay.com/photo/2014/09/24/14/29/macbook-459196_150.jpg","previewWidth":150,"previewHeight":92,"webformatURL":"https://pixabay.com/get/g7f68a5a3c9c81ade77c3723ff6e5b2f326f7a82d0ee4fb5664f76e5e4b2c80dd1db11cd571abb7f27f98c15cede3627d_640.jpg","webformatWidth":640,"webformatHeight":396,"largeImageURL":"https://pixabay.com/get/g1a20e9ad9afe0921c3a492d286ae8110fa75f472ea93f5e07c4319200ce60b9b7733e5b45aa118606b07811f58be50fe95b0c71409c66f555e47c8cc6ad0b3ef_1280.jpg","imageWidth":3888,"imageHeight":2406,"imageSize":2883743,"views":498016,"downloads":246222,"collections":4975,"likes":697,"comments":198,"user_id":377053,"user":"377053","userImageURL":""},{"id":3113279,"pageURL":"https://pixabay.com/photos/internet-whatsapp-smartphone-3113279/","type":"photo","tags":"internet, whatsapp, smartphone","previewURL":"https://cdn.pixabay.com/photo/2018/01/28/10/59/internet-3113279_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g97f5e37f1ca6b7a39086601c5e6a35b4d117c62078b7db272474476f0226ecccf8e71536e79d869bc005772522159fe007a14d7b623e38a189771b017dd851c5_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g6fb91c1602d7c41b4aa5bc6a58dc12f4f15c89818efba71e2fdefec6072236a0c8663804bbd97302807dc46866e16edd55a6361fc12722b9648e50cc9f4eea15_1280.jpg","imageWidth":5616,"imageHeight":3744,"imageSize":2904510,"views":218147,"downloads":126529,"collections":2934,"likes":364,"comments":72,"user_id":13838,"user":"LoboStudioHamburg","userImageURL":"https://cdn.pixabay.com/user/2012/11/18/16-48-54-297_250x250.jpg"},{"id":763731,"pageURL":"https://pixabay.com/photos/social-media-facebook-smartphone-763731/","type":"photo","tags":"social media, facebook, smartphone","previewURL":"https://cdn.pixabay.com/photo/2015/05/12/09/13/social-media-763731_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g7c27c6cdb535d52c7fdb25ebc865c90fe1c32b3da6a59835026635c7c85a839df3c02eda58f3bb66af62926bb270632e_640.jpg","webformatWidth":640,"webformatHeight":425,"largeImageURL":"https://pixabay.com/get/gf1251b5b02333d34d0692b3c64062854cdcf64201a9b4a1e9643d5258ad4a7980526947d67661b1fb5df212d22978129ebf0f3218eb83a84d6e51e2f32d474f0_1280.jpg","imageWidth":3967,"imageHeight":2635,"imageSize":2511740,"views":211475,"downloads":123347,"collections":2507,"likes":403,"comments":91,"user_id":663163,"user":"Firmbee","userImageURL":"https://cdn.pixabay.com/user/2020/11/25/09-38-28-431_250x250.png"},{"id":1841553,"pageURL":"https://pixabay.com/photos/apple-iphone-notebook-pen-1841553/","type":"photo","tags":"apple, iphone, notebook","previewURL":"https://cdn.pixabay.com/photo/2016/11/19/22/53/apple-1841553_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g9b025da6fd4b7f71474b08b17395216f1e36776db9fabf2a8d724dcc0fdad88a8c1cc34c674981b09ab1e467411952070108bd90a5c339849c02a34c04744ffc_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g7d76cc7d4f6b1d963eb441d9ba8552a56e84fdbacf5ef23d5ab1da57300c7d58295439ebb932fabae36e314f58f9b11b04612b187d2d825112e611a6fa15feb9_1280.jpg","imageWidth":3733,"imageHeight":2489,"imageSize":3052025,"views":74569,"downloads":47545,"collections":1212,"likes":183,"comments":23,"user_id":2286921,"user":"Pexels","userImageURL":"https://cdn.pixabay.com/user/2016/03/26/22-06-36-459_250x250.jpg"},{"id":1979674,"pageURL":"https://pixabay.com/photos/relaxing-lounging-saturday-cozy-1979674/","type":"photo","tags":"relaxing, lounging, saturday","previewURL":"https://cdn.pixabay.com/photo/2017/01/14/15/11/relaxing-1979674_150.jpg","previewWidth":150,"previewHeight":102,"webformatURL":"https://pixabay.com/get/ga8b5f9697d04290318e2068b9a0ed470cb5f0cef5634a9012db0ffc3c82ca924f2ef38fcd38dd14b999625dd6a05d997c0f68cf5d0895b49b72f0a58c5fdee6d_640.jpg","webformatWidth":640,"webformatHeight":438,"largeImageURL":"https://pixabay.com/get/gdf134fd506637ccc069b84a2753f81b81279c22274e80f59c225a3a3f20845bf514644180ed05636966ef8bfa2bf726b2d38d930dc7911e66f3e1a688590459f_1280.jpg","imageWidth":5310,"imageHeight":3637,"imageSize":3751070,"views":370342,"downloads":212646,"collections":3899,"likes":1103,"comments":137,"user_id":334088,"user":"JillWellington","userImageURL":"https://cdn.pixabay.com/user/2018/06/27/01-23-02-27_250x250.jpg"},{"id":3076954,"pageURL":"https://pixabay.com/photos/desk-smartphone-iphone-notebook-3076954/","type":"photo","tags":"desk, smartphone, iphone","previewURL":"https://cdn.pixabay.com/photo/2018/01/11/21/27/desk-3076954_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/gfd824a3e92883100a6a77caf01fcc8af9daee02d18d9bb761dc56c830f2c2d01638033f133bf9cabe2dc619dd1d58e5e44f890ac49fb3f81d2c71edbe1bc95eb_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g53a73988d9f989db5f1e6ef95650e27970b1249c2ebf0defdc9c47b2678c3102b2dbab1148a91205ed3ea17c2da683ab730d28296d9be4fc94541aa0bea5c8a5_1280.jpg","imageWidth":5304,"imageHeight":3531,"imageSize":2258922,"views":210964,"downloads":134209,"collections":3024,"likes":526,"comments":97,"user_id":2218222,"user":"Ylanite","userImageURL":"https://cdn.pixabay.com/user/2021/11/18/21-11-44-855_250x250.png"},{"id":6588614,"pageURL":"https://pixabay.com/photos/woman-butterflies-fashion-people-6588614/","type":"photo","tags":"woman, butterflies, fashion","previewURL":"https://cdn.pixabay.com/photo/2021/08/31/11/58/woman-6588614_150.jpg","previewWidth":106,"previewHeight":150,"webformatURL":"https://pixabay.com/get/g3691be5fc7ca559ed920cb8743ed28aed4f57dce36129446eb59b1ebcc7c8d13a5ecb0517f6d32fa02780d4d2e9b6706dc5a843d602b425eb93d9feb2bf1a6d5_640.jpg","webformatWidth":453,"webformatHeight":640,"largeImageURL":"https://pixabay.com/get/g651a0c7faa3e9a2db131eb7024666d0974ecea5a1758317f2a03f77cc5e8b56a645b3487e86fc877bbccb2c11b4e3dd953770f89130e732cff3ce8914bc19e1c_1280.jpg","imageWidth":4000,"imageHeight":5645,"imageSize":3056377,"views":150587,"downloads":131089,"collections":3063,"likes":202,"comments":23,"user_id":23172418,"user":"Wangphan","userImageURL":"https://cdn.pixabay.com/user/2021/08/31/11-28-28-241_250x250.jpg"},{"id":586266,"pageURL":"https://pixabay.com/photos/telephone-mobile-call-samsung-586266/","type":"photo","tags":"telephone, mobile, call","previewURL":"https://cdn.pixabay.com/photo/2015/01/01/23/55/telephone-586266_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/ge85b35005ad6fb9c09b687f2d1477b0bed84cf41aaa132cda626e401a5546e112d8207e7ee7ca96cf942b6e79d9fa00f_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/ged8636015dbd46f9c493843950baae9fb0651f910c91dc21a2194109a2dd7885c46bc8a128af4c0ae46002100f8b341a3ea12bd2ce9ab86cdc2d94c4dd6ed345_1280.jpg","imageWidth":4936,"imageHeight":3291,"imageSize":2752598,"views":218288,"downloads":134684,"collections":2137,"likes":303,"comments":72,"user_id":80788,"user":"niekverlaan","userImageURL":"https://cdn.pixabay.com/user/2014/05/19/00-26-35-848_250x250.jpg"},{"id":1599527,"pageURL":"https://pixabay.com/photos/mystery-island-dinosaur-skull-1599527/","type":"photo","tags":"mystery, island, dinosaur","previewURL":"https://cdn.pixabay.com/photo/2016/08/17/01/39/mystery-1599527_150.jpg","previewWidth":116,"previewHeight":150,"webformatURL":"https://pixabay.com/get/gd5d9d9887b8827cd46ba9e0816a619f94b9fd23543a2b3dbdbfc1ca4e3245cb918e164ae389cc805ee8271ec3d922f08215563afca07edf024f23746f80e4937_640.jpg","webformatWidth":495,"webformatHeight":640,"largeImageURL":"https://pixabay.com/get/g3319bac9b4e681f23dc0aae732ee30de7be2bb5da5ae7447e4121686ac2ddd1c623d9366728d6bb6b021da727f66422a54125892077c8b486c2b088fd081f9a5_1280.jpg","imageWidth":3022,"imageHeight":3907,"imageSize":3563541,"views":566051,"downloads":280735,"collections":3683,"likes":1248,"comments":150,"user_id":2633886,"user":"intographics","userImageURL":"https://cdn.pixabay.com/user/2019/02/11/15-00-48-80_250x250.jpg"},{"id":2369664,"pageURL":"https://pixabay.com/photos/art-multicoloured-to-dye-abstract-2369664/","type":"photo","tags":"art, multicoloured, to dye","previewURL":"https://cdn.pixabay.com/photo/2017/06/03/20/12/art-2369664_150.jpg","previewWidth":99,"previewHeight":150,"webformatURL":"https://pixabay.com/get/g91be293ba6c0d4d90bad883d6ecaf4c25a1ef8327e90dabb4b65848de9a134a869884fa4c9940ceb58af1e7e42435f29c06a2e298dc8d61cfd3588aa31951013_640.jpg","webformatWidth":424,"webformatHeight":640,"largeImageURL":"https://pixabay.com/get/g9619ef3232dbec061d816efa5085f1b271a2bdee18244b1233aece2d7db1cbe0e800a1a7ce7d7ee52f0ac45a1dbab3230c4f6552b201db34289c979e5557fe93_1280.jpg","imageWidth":3264,"imageHeight":4928,"imageSize":4032363,"views":365726,"downloads":322639,"collections":3136,"likes":513,"comments":58,"user_id":4894494,"user":"eluela31","userImageURL":"https://cdn.pixabay.com/user/2017/04/24/19-55-29-652_250x250.jpg"},{"id":5987093,"pageURL":"https://pixabay.com/photos/laptop-mobile-phone-table-phone-5987093/","type":"photo","tags":"laptop, mobile phone, table","previewURL":"https://cdn.pixabay.com/photo/2021/02/06/07/02/laptop-5987093_150.jpg","previewWidth":150,"previewHeight":100,"webformatURL":"https://pixabay.com/get/gd5c7198c79b0329b34f3fab421637df18042c42cf2cfa14de9ae4b84558c2e79bdb3c472a256370212ed6f3700069cf12a9f7fecf4bd7d1fd7e1a3d27b75d9fd_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g63cb781d6813e71b11dca027826bbde4f94708b93842ce58db02f51d12a5fea905ed6b37795b6d37a3c6fb45ce38c7a6b2d3b231d33cc4e3d3ded18dc4d985e5_1280.jpg","imageWidth":4029,"imageHeight":2681,"imageSize":2360293,"views":11991,"downloads":7066,"collections":654,"likes":36,"comments":14,"user_id":5099306,"user":"kieutruongphoto","userImageURL":"https://cdn.pixabay.com/user/2021/09/03/12-10-14-149_250x250.jpg"}]}
""";